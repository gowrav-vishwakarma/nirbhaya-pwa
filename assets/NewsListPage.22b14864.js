import{i as oe,g as E,l as re,e as _,k as ie,f as ue,h as R,d as ce,G as de,z as pe,u as ve,r as f,B as fe,v as ge,D as h,R as $,S as r,V as n,$ as F,E as T,au as M,at as z,a0 as L,T as a,bt as me,Y as S,Z as he,X as A,ap as D,al as V,aM as ye,ag as H,ao as O,ae as be,aI as j,aJ as we,a3 as xe,F as _e,bS as C,aN as Ce,bm as G,aq as X}from"./index.168e4218.js";const ke={position:{type:String,default:"bottom-right",validator:u=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(u)},offset:{type:Array,validator:u=>u.length===2},expand:Boolean};function Se(){const{props:u,proxy:{$q:c}}=ie(),s=oe(re,E);if(s===E)return console.error("QPageSticky needs to be child of QLayout"),E;const g=_(()=>{const o=u.position;return{top:o.indexOf("top")!==-1,right:o.indexOf("right")!==-1,bottom:o.indexOf("bottom")!==-1,left:o.indexOf("left")!==-1,vertical:o==="top"||o==="bottom",horizontal:o==="left"||o==="right"}}),y=_(()=>s.header.offset),m=_(()=>s.right.offset),i=_(()=>s.footer.offset),d=_(()=>s.left.offset),b=_(()=>{let o=0,p=0;const v=g.value,P=c.lang.rtl===!0?-1:1;v.top===!0&&y.value!==0?p=`${y.value}px`:v.bottom===!0&&i.value!==0&&(p=`${-i.value}px`),v.left===!0&&d.value!==0?o=`${P*d.value}px`:v.right===!0&&m.value!==0&&(o=`${-P*m.value}px`);const w={transform:`translate(${o}, ${p})`};return u.offset&&(w.margin=`${u.offset[1]}px ${u.offset[0]}px`),v.vertical===!0?(d.value!==0&&(w[c.lang.rtl===!0?"right":"left"]=`${d.value}px`),m.value!==0&&(w[c.lang.rtl===!0?"left":"right"]=`${m.value}px`)):v.horizontal===!0&&(y.value!==0&&(w.top=`${y.value}px`),i.value!==0&&(w.bottom=`${i.value}px`)),w}),q=_(()=>`q-page-sticky row flex-center fixed-${u.position} q-page-sticky--${u.expand===!0?"expand":"shrink"}`);function Q(o){const p=ue(o.default);return R("div",{class:q.value,style:b.value},u.expand===!0?p:[R("div",p)])}return{$layout:s,getStickyContent:Q}}var Ne=ce({name:"QPageSticky",props:ke,setup(u,{slots:c}){const{getStickyContent:s}=Se();return()=>s(c)}});const $e={class:"row q-col-gutter-md"},qe={class:"col-12",style:{"margin-top":"-15px"}},Qe={class:"row q-col-gutter-md"},Pe={class:"row items-center q-gutter-x-sm"},Te={class:"row items-center q-gutter-x-sm"},Le={class:"text-h6 q-mt-sm"},Ve={class:"text-body2 q-mt-sm text-grey-8 _ellipsis-3-lines"},Be={class:"row justify-center q-mt-md"},Ue={class:"column q-gutter-y-md"},Ee={class:"row q-pa-sm justify-center"},Y=6,Fe=pe({__name:"NewsListPage",setup(u){const c=ve(),s=f([]),g=f(!1),y=f(1),m=f(!0),i=f(c.newsPreferences.language||"en"),d=f(c.newsPreferences.categories||[]),b=f(c.newsPreferences.newsType||"all"),q=[{label:"English",value:"en"},{label:"Hindi",value:"hi"},{label:"Bengali",value:"bn"},{label:"Tamil",value:"ta"},{label:"Telugu",value:"te"},{label:"Gujarati",value:"gu"},{label:"Marathi",value:"mr"},{label:"Malayalam",value:"ml"}],Q=[{label:"Sports",value:"sports"},{label:"Technology",value:"technology"},{label:"Business",value:"business"},{label:"Entertainment",value:"entertainment"},{label:"Science",value:"science"},{label:"Health",value:"health"},{label:"Lifestyle",value:"lifestyle"},{label:"Education",value:"education"},{label:"Politics",value:"politics"},{label:"Startup",value:"startup"}],o=[{label:"All News",value:"all"},{label:"Indian News",value:"indian"},{label:"International News",value:"international"}],p=f(!1),v=_(()=>{var t;let e=0;return i.value!=="en"&&e++,((t=d.value)==null?void 0:t.length)>0&&e++,b.value!=="all"&&e++,e}),P=e=>{var t;return((t=Q.find(l=>l.value===e))==null?void 0:t.label)||e},w=e=>{var l;const t=(l=e.translations)==null?void 0:l.find(x=>x.languageCode===i.value);return(t==null?void 0:t.title)||e.title},J=e=>{var l;const t=(l=e.translations)==null?void 0:l.find(x=>x.languageCode===i.value);return(t==null?void 0:t.content)||e.content},K=e=>{const t={}.IMAGE_CDN_URL||"";return e?e.startsWith("http")?e:`${t}${e}`:""},I=e=>{var t;return((t=q.find(l=>l.value===e))==null?void 0:t.label)||e},W=e=>{var l;return((l=e.translations)==null?void 0:l.some(x=>x.languageCode===i.value))?I(i.value):I(e.defaultLanguage)};async function k(e=!1){var t;if(e&&(y.value=1,s.value=[],m.value=!0),!(!m.value||g.value))try{g.value=!0,B.value=!0;const l=await _e.get("/news/user-news",{params:{page:y.value,pageSize:Y,language:i.value,categories:((t=d.value)==null?void 0:t.length)>0?d.value:void 0,newsType:b.value}});e?s.value=l.data.items:s.value=[...s.value,...l.data.items],m.value=s.value.length<l.data.total,y.value++}catch(l){console.error("Error fetching news:",l)}finally{g.value=!1,B.value=!1}}function Z(e){i.value=e,c.setNewsPreferences({language:e}),k(!0)}function ee(e){d.value=e||[],c.setNewsPreferences({categories:e||[]}),k(!0)}function te(e){b.value=e,c.setNewsPreferences({newsType:e}),k(!0)}function le(){k()}async function ae(){i.value="en",d.value=[],b.value="all",c.setNewsPreferences({language:"en",categories:[],newsType:"all"}),p.value=!1,await k(!0)}function se(e){if(!e)return;const t=e.match(/^https?:\/\//)?e:`http://${e}`;window.open(t,"_blank","noopener,noreferrer")}const N=f(null),B=f(!1);function ne(){const e={root:null,rootMargin:"0px",threshold:.5},t=new IntersectionObserver(([l])=>{l.isIntersecting&&!g.value&&m.value&&!B.value&&le()},e);return N.value&&t.observe(N.value),()=>{N.value&&t.unobserve(N.value)}}return fe(()=>{k();const e=ne();ge(e)}),(e,t)=>(h(),$(xe,{padding:"",style:{"padding-top":"env(safe-area-inset-top)"}},{default:r(()=>[n("div",$e,[t[6]||(t[6]=n("div",{class:"col-12"},[n("div",{class:"row items-center justify-between q-ma-none"},[n("div",{class:"text-h6 q-pl-sm q-py-md",style:{color:"white","font-weight":"900"}},[F(" Bulletin Feed "),n("div",{class:"text-caption text-white-6"}," AI summaries and translations may be inaccurate. Check source. ")])])],-1)),n("div",qe,[n("div",Qe,[g.value&&s.value.length===0?(h(),T(z,{key:0},M(Y,l=>n("div",{key:l,class:"col-12 col-sm-6 col-md-4"},[a(D,{class:"news-card"},{default:r(()=>[a(C,{height:"200px",square:""}),a(V,null,{default:r(()=>[n("div",Pe,[a(C,{type:"QChip",width:"60px"}),a(C,{type:"QChip",width:"80px"})]),a(C,{type:"text",class:"text-h6 q-mt-sm"}),a(C,{type:"text",class:"q-mt-sm"}),a(C,{type:"text",width:"60%"})]),_:1}),a(j,{align:"right"},{default:r(()=>[a(C,{type:"QBtn",width:"90px"})]),_:1})]),_:1})])),64)):L("",!0),(h(!0),T(z,null,M(s.value,l=>(h(),T("div",{key:l.id,class:"col-12 col-sm-6 col-md-4"},[a(D,{class:"news-card"},{default:r(()=>{var x;return[(x=l.mediaUrls)!=null&&x.length?(h(),$(Ce,{key:0,src:K(l.mediaUrls[0]),ratio:16/9},null,8,["src"])):L("",!0),a(V,null,{default:r(()=>[n("div",Te,[(h(!0),T(z,null,M(l.categories,U=>(h(),$(G,{key:U,size:"sm",label:P(U)},null,8,["label"]))),128)),a(G,{size:"sm",label:l.isIndianNews?"Indian":"International",color:l.isIndianNews?"primary":"secondary","text-color":"white"},null,8,["label","color"]),a(G,{size:"sm",label:W(l),color:"accent","text-color":"white"},null,8,["label"])]),n("div",Le,A(w(l)),1),n("div",Ve,A(J(l)),1)]),_:2},1024),a(j,{align:"right"},{default:r(()=>[l.source?(h(),$(S,{key:0,flat:"",color:"secondary",icon:"link",label:"Source (English)",onClick:U=>se(l.source)},null,8,["onClick"])):L("",!0)]),_:2},1024)]}),_:2},1024)]))),128))]),n("div",Be,[n("div",{ref_key:"scrollTarget",ref:N,style:{height:"20px",width:"100%","text-align":"center"}},[a(me,{showing:g.value&&s.value.length>0,size:"40px",color:"white"},null,8,["showing"])],512)])])]),a(Ne,{position:"bottom-left",offset:[18,18]},{default:r(()=>[a(S,{rounded:"",color:"primary",icon:"tune",onClick:t[0]||(t[0]=l=>p.value=!0)},{default:r(()=>[t[7]||(t[7]=F(" Filters ")),v.value?(h(),$(he,{key:0,color:"primary",floating:"",class:"q-ml-sm"},{default:r(()=>[F(A(v.value),1)]),_:1})):L("",!0)]),_:1})]),_:1}),a(we,{modelValue:p.value,"onUpdate:modelValue":t[5]||(t[5]=l=>p.value=l),position:"right"},{default:r(()=>[a(D,{style:{"min-width":"85vw","max-width":"95vw"}},{default:r(()=>[a(V,{class:"row items-center"},{default:r(()=>[t[8]||(t[8]=n("div",{class:"text-h6"},"Filter Bulletin",-1)),a(ye),H(a(S,{icon:"close",flat:"",round:"",dense:""},null,512),[[X]])]),_:1}),a(V,{class:"q-pt-none"},{default:r(()=>[n("div",Ue,[a(O,{modelValue:b.value,"onUpdate:modelValue":[t[1]||(t[1]=l=>b.value=l),te],options:o,label:"News Type","emit-value":"","map-options":""},null,8,["modelValue"]),a(O,{modelValue:i.value,"onUpdate:modelValue":[t[2]||(t[2]=l=>i.value=l),Z],options:q,label:"Language","emit-value":"","map-options":""},null,8,["modelValue"]),a(O,{ref:"categorySelect",modelValue:d.value,"onUpdate:modelValue":[t[3]||(t[3]=l=>d.value=l),ee],options:Q,label:"Categories",multiple:"","emit-value":"","map-options":"","use-chips":"",clearable:""},{"after-options":r(()=>[a(be),n("div",Ee,[H(a(S,{color:"primary",label:"Done"},null,512),[[X]])])]),_:1},8,["modelValue"])])]),_:1}),a(j,{align:"right"},{default:r(()=>[a(S,{flat:"",label:"Clear All",color:"grey-7",onClick:ae,disable:!v.value,loading:g.value},null,8,["disable","loading"]),a(S,{flat:"",label:"Apply",color:"primary",onClick:t[4]||(t[4]=l=>p.value=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});var ze=de(Fe,[["__scopeId","data-v-228c5997"]]);export{ze as default};
